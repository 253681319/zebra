<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>data.js - Zebra API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1>Zebra API: data.js</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 07/2013</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Packages</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/data.html">data</a>
                
                </li>
            
                <li><a href="../modules/io.html">io</a>
                
                </li>
            
                <li><a href="../modules/layout.html">layout</a>
                
                </li>
            
                <li><a href="../modules/ui.html">ui</a>
                
                </li>
            
                <li><a href="../modules/ui.designer.html">ui.designer</a>
                
                </li>
            
                <li><a href="../modules/ui.grid.html">ui.grid</a>
                
                </li>
            
                <li><a href="../modules/ui.tree.html">ui.tree</a>
                
                </li>
            
                <li><a href="../modules/util.html">util</a>
                
                </li>
            
                <li><a href="../modules/zebra.html">zebra</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Classes and interfaces</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/zebra.Class().html">zebra.Class()</a></li>
            
                <li><a href="../classes/zebra.data.Item.html">zebra.data.Item</a></li>
            
                <li><a href="../classes/zebra.data.ListModel.html">zebra.data.ListModel</a></li>
            
                <li><a href="../classes/zebra.data.Matrix.html">zebra.data.Matrix</a></li>
            
                <li><a href="../classes/zebra.data.SingleLineTxt.html">zebra.data.SingleLineTxt</a></li>
            
                <li><a href="../classes/zebra.data.Text.html">zebra.data.Text</a></li>
            
                <li><a href="../classes/zebra.data.TextModel.html">zebra.data.TextModel</a></li>
            
                <li><a href="../classes/zebra.data.TreeModel.html">zebra.data.TreeModel</a></li>
            
                <li><a href="../classes/zebra.Dummy.html">zebra.Dummy</a></li>
            
                <li><a href="../classes/zebra.forName().html">zebra.forName()</a></li>
            
                <li><a href="../classes/zebra.instanceOf().html">zebra.instanceOf()</a></li>
            
                <li><a href="../classes/zebra.Interface().html">zebra.Interface()</a></li>
            
                <li><a href="../classes/zebra.io.b64decode().html">zebra.io.b64decode()</a></li>
            
                <li><a href="../classes/zebra.io.b64encode().html">zebra.io.b64encode()</a></li>
            
                <li><a href="../classes/zebra.io.GET().html">zebra.io.GET()</a></li>
            
                <li><a href="../classes/zebra.io.HTTP.html">zebra.io.HTTP</a></li>
            
                <li><a href="../classes/zebra.io.ID().html">zebra.io.ID()</a></li>
            
                <li><a href="../classes/zebra.io.JRPC.html">zebra.io.JRPC</a></li>
            
                <li><a href="../classes/zebra.io.JRPC.invoke().html">zebra.io.JRPC.invoke()</a></li>
            
                <li><a href="../classes/zebra.io.POST().html">zebra.io.POST()</a></li>
            
                <li><a href="../classes/zebra.io.QS.html">zebra.io.QS</a></li>
            
                <li><a href="../classes/zebra.io.Service.html">zebra.io.Service</a></li>
            
                <li><a href="../classes/zebra.io.XRPC.html">zebra.io.XRPC</a></li>
            
                <li><a href="../classes/zebra.io.XRPC.invoke().html">zebra.io.XRPC.invoke()</a></li>
            
                <li><a href="../classes/zebra.layout.BorderLayout.html">zebra.layout.BorderLayout</a></li>
            
                <li><a href="../classes/zebra.layout.Constraints.html">zebra.layout.Constraints</a></li>
            
                <li><a href="../classes/zebra.layout.FlowLayout.html">zebra.layout.FlowLayout</a></li>
            
                <li><a href="../classes/zebra.layout.getAbsLocation().html">zebra.layout.getAbsLocation()</a></li>
            
                <li><a href="../classes/zebra.layout.getDirectAt().html">zebra.layout.getDirectAt()</a></li>
            
                <li><a href="../classes/zebra.layout.getDirectChild().html">zebra.layout.getDirectChild()</a></li>
            
                <li><a href="../classes/zebra.layout.getTopParent().html">zebra.layout.getTopParent()</a></li>
            
                <li><a href="../classes/zebra.layout.GridLayout.html">zebra.layout.GridLayout</a></li>
            
                <li><a href="../classes/zebra.layout.Layout.html">zebra.layout.Layout</a></li>
            
                <li><a href="../classes/zebra.layout.Layoutable.html">zebra.layout.Layoutable</a></li>
            
                <li><a href="../classes/zebra.layout.ListLayout.html">zebra.layout.ListLayout</a></li>
            
                <li><a href="../classes/zebra.layout.PercentLayout.html">zebra.layout.PercentLayout</a></li>
            
                <li><a href="../classes/zebra.layout.RasterLayout.html">zebra.layout.RasterLayout</a></li>
            
                <li><a href="../classes/zebra.layout.StackLayout.html">zebra.layout.StackLayout</a></li>
            
                <li><a href="../classes/zebra.ready().html">zebra.ready()</a></li>
            
                <li><a href="../classes/zebra.ui.BaseLayer.html">zebra.ui.BaseLayer</a></li>
            
                <li><a href="../classes/zebra.ui.BaseList.html">zebra.ui.BaseList</a></li>
            
                <li><a href="../classes/zebra.ui.BoldLabel.html">zebra.ui.BoldLabel</a></li>
            
                <li><a href="../classes/zebra.ui.Border.html">zebra.ui.Border</a></li>
            
                <li><a href="../classes/zebra.ui.BorderPan.html">zebra.ui.BorderPan</a></li>
            
                <li><a href="../classes/zebra.ui.Button.html">zebra.ui.Button</a></li>
            
                <li><a href="../classes/zebra.ui.Checkbox.html">zebra.ui.Checkbox</a></li>
            
                <li><a href="../classes/zebra.ui.Checkbox.Box.html">zebra.ui.Checkbox.Box</a></li>
            
                <li><a href="../classes/zebra.ui.ChildrenListener.html">zebra.ui.ChildrenListener</a></li>
            
                <li><a href="../classes/zebra.ui.Combo.html">zebra.ui.Combo</a></li>
            
                <li><a href="../classes/zebra.ui.Combo.ContentPan.html">zebra.ui.Combo.ContentPan</a></li>
            
                <li><a href="../classes/zebra.ui.Combo.EditableContentPan.html">zebra.ui.Combo.EditableContentPan</a></li>
            
                <li><a href="../classes/zebra.ui.Combo.ReadonlyContentPan.html">zebra.ui.Combo.ReadonlyContentPan</a></li>
            
                <li><a href="../classes/zebra.ui.ComboArrowView.html">zebra.ui.ComboArrowView</a></li>
            
                <li><a href="../classes/zebra.ui.CommandManager.html">zebra.ui.CommandManager</a></li>
            
                <li><a href="../classes/zebra.ui.CompList.html">zebra.ui.CompList</a></li>
            
                <li><a href="../classes/zebra.ui.ComponentListener.html">zebra.ui.ComponentListener</a></li>
            
                <li><a href="../classes/zebra.ui.Composite.html">zebra.ui.Composite</a></li>
            
                <li><a href="../classes/zebra.ui.CompositeView.html">zebra.ui.CompositeView</a></li>
            
                <li><a href="../classes/zebra.ui.CompRender.html">zebra.ui.CompRender</a></li>
            
                <li><a href="../classes/zebra.ui.CopyCutPaste.html">zebra.ui.CopyCutPaste</a></li>
            
                <li><a href="../classes/zebra.ui.Cursorable.html">zebra.ui.Cursorable</a></li>
            
                <li><a href="../classes/zebra.ui.CursorManager.html">zebra.ui.CursorManager</a></li>
            
                <li><a href="../classes/zebra.ui.designer.ShaperPan.html">zebra.ui.designer.ShaperPan</a></li>
            
                <li><a href="../classes/zebra.ui.Dotted.html">zebra.ui.Dotted</a></li>
            
                <li><a href="../classes/zebra.ui.Etched.html">zebra.ui.Etched</a></li>
            
                <li><a href="../classes/zebra.ui.EventManager.html">zebra.ui.EventManager</a></li>
            
                <li><a href="../classes/zebra.ui.findCanvas().html">zebra.ui.findCanvas()</a></li>
            
                <li><a href="../classes/zebra.ui.FocusListener.html">zebra.ui.FocusListener</a></li>
            
                <li><a href="../classes/zebra.ui.FocusManager.html">zebra.ui.FocusManager</a></li>
            
                <li><a href="../classes/zebra.ui.Font.html">zebra.ui.Font</a></li>
            
                <li><a href="../classes/zebra.ui.Gradient.html">zebra.ui.Gradient</a></li>
            
                <li><a href="../classes/zebra.ui.grid.DefEditors.html">zebra.ui.grid.DefEditors</a></li>
            
                <li><a href="../classes/zebra.ui.grid.Grid.html">zebra.ui.grid.Grid</a></li>
            
                <li><a href="../classes/zebra.ui.grid.GridCaption.html">zebra.ui.grid.GridCaption</a></li>
            
                <li><a href="../classes/zebra.ui.grid.GridStretchPan.html">zebra.ui.grid.GridStretchPan</a></li>
            
                <li><a href="../classes/zebra.ui.grid.Metrics.html">zebra.ui.grid.Metrics</a></li>
            
                <li><a href="../classes/zebra.ui.Group.html">zebra.ui.Group</a></li>
            
                <li><a href="../classes/zebra.ui.HtmlElement.html">zebra.ui.HtmlElement</a></li>
            
                <li><a href="../classes/zebra.ui.HtmlTextArea.html">zebra.ui.HtmlTextArea</a></li>
            
                <li><a href="../classes/zebra.ui.HtmlTextField.html">zebra.ui.HtmlTextField</a></li>
            
                <li><a href="../classes/zebra.ui.HtmlTextInput.html">zebra.ui.HtmlTextInput</a></li>
            
                <li><a href="../classes/zebra.ui.ImageLabel.html">zebra.ui.ImageLabel</a></li>
            
                <li><a href="../classes/zebra.ui.ImagePan.html">zebra.ui.ImagePan</a></li>
            
                <li><a href="../classes/zebra.ui.InputEvent.html">zebra.ui.InputEvent</a></li>
            
                <li><a href="../classes/zebra.ui.KeyEvent.html">zebra.ui.KeyEvent</a></li>
            
                <li><a href="../classes/zebra.ui.KeyListener.html">zebra.ui.KeyListener</a></li>
            
                <li><a href="../classes/zebra.ui.Label.html">zebra.ui.Label</a></li>
            
                <li><a href="../classes/zebra.ui.List.html">zebra.ui.List</a></li>
            
                <li><a href="../classes/zebra.ui.List.ViewProvider.html">zebra.ui.List.ViewProvider</a></li>
            
                <li><a href="../classes/zebra.ui.loadImage().html">zebra.ui.loadImage()</a></li>
            
                <li><a href="../classes/zebra.ui.Manager.html">zebra.ui.Manager</a></li>
            
                <li><a href="../classes/zebra.ui.Menu.html">zebra.ui.Menu</a></li>
            
                <li><a href="../classes/zebra.ui.Menunbar.html">zebra.ui.Menunbar</a></li>
            
                <li><a href="../classes/zebra.ui.MLabel.html">zebra.ui.MLabel</a></li>
            
                <li><a href="../classes/zebra.ui.MouseEvent.html">zebra.ui.MouseEvent</a></li>
            
                <li><a href="../classes/zebra.ui.MouseListener.html">zebra.ui.MouseListener</a></li>
            
                <li><a href="../classes/zebra.ui.MouseWheelSupport.html">zebra.ui.MouseWheelSupport</a></li>
            
                <li><a href="../classes/zebra.ui.PaintManager.html">zebra.ui.PaintManager</a></li>
            
                <li><a href="../classes/zebra.ui.PaintManImpl.html">zebra.ui.PaintManImpl</a></li>
            
                <li><a href="../classes/zebra.ui.Panel.html">zebra.ui.Panel</a></li>
            
                <li><a href="../classes/zebra.ui.PasswordText.html">zebra.ui.PasswordText</a></li>
            
                <li><a href="../classes/zebra.ui.Pattern.html">zebra.ui.Pattern</a></li>
            
                <li><a href="../classes/zebra.ui.Picture.html">zebra.ui.Picture</a></li>
            
                <li><a href="../classes/zebra.ui.PopupInfo.html">zebra.ui.PopupInfo</a></li>
            
                <li><a href="../classes/zebra.ui.PopupLayer.html">zebra.ui.PopupLayer</a></li>
            
                <li><a href="../classes/zebra.ui.PopupManager.html">zebra.ui.PopupManager</a></li>
            
                <li><a href="../classes/zebra.ui.Progress.html">zebra.ui.Progress</a></li>
            
                <li><a href="../classes/zebra.ui.Radial.html">zebra.ui.Radial</a></li>
            
                <li><a href="../classes/zebra.ui.Radiobox.html">zebra.ui.Radiobox</a></li>
            
                <li><a href="../classes/zebra.ui.RadioView.html">zebra.ui.RadioView</a></li>
            
                <li><a href="../classes/zebra.ui.Raised.html">zebra.ui.Raised</a></li>
            
                <li><a href="../classes/zebra.ui.Render.html">zebra.ui.Render</a></li>
            
                <li><a href="../classes/zebra.ui.RootLayer.html">zebra.ui.RootLayer</a></li>
            
                <li><a href="../classes/zebra.ui.RoundBorder.html">zebra.ui.RoundBorder</a></li>
            
                <li><a href="../classes/zebra.ui.Scroll.html">zebra.ui.Scroll</a></li>
            
                <li><a href="../classes/zebra.ui.ScrollManager.html">zebra.ui.ScrollManager</a></li>
            
                <li><a href="../classes/zebra.ui.ScrollPan.html">zebra.ui.ScrollPan</a></li>
            
                <li><a href="../classes/zebra.ui.Slider.html">zebra.ui.Slider</a></li>
            
                <li><a href="../classes/zebra.ui.SplitPan.html">zebra.ui.SplitPan</a></li>
            
                <li><a href="../classes/zebra.ui.StatePan.html">zebra.ui.StatePan</a></li>
            
                <li><a href="../classes/zebra.ui.Sunken.html">zebra.ui.Sunken</a></li>
            
                <li><a href="../classes/zebra.ui.SwitchManager.html">zebra.ui.SwitchManager</a></li>
            
                <li><a href="../classes/zebra.ui.Tabs.html">zebra.ui.Tabs</a></li>
            
                <li><a href="../classes/zebra.ui.TextArea.html">zebra.ui.TextArea</a></li>
            
                <li><a href="../classes/zebra.ui.TextField.html">zebra.ui.TextField</a></li>
            
                <li><a href="../classes/zebra.ui.TextRender.html">zebra.ui.TextRender</a></li>
            
                <li><a href="../classes/zebra.ui.Toolbar.html">zebra.ui.Toolbar</a></li>
            
                <li><a href="../classes/zebra.ui.TooltipInfo.html">zebra.ui.TooltipInfo</a></li>
            
                <li><a href="../classes/zebra.ui.TooltipManager.html">zebra.ui.TooltipManager</a></li>
            
                <li><a href="../classes/zebra.ui.tree.DefEditors.html">zebra.ui.tree.DefEditors</a></li>
            
                <li><a href="../classes/zebra.ui.tree.DefViews.html">zebra.ui.tree.DefViews</a></li>
            
                <li><a href="../classes/zebra.ui.tree.Tree.html">zebra.ui.tree.Tree</a></li>
            
                <li><a href="../classes/zebra.ui.View.html">zebra.ui.View</a></li>
            
                <li><a href="../classes/zebra.ui.ViewPan.html">zebra.ui.ViewPan</a></li>
            
                <li><a href="../classes/zebra.ui.ViewSet.html">zebra.ui.ViewSet</a></li>
            
                <li><a href="../classes/zebra.ui.Window.html">zebra.ui.Window</a></li>
            
                <li><a href="../classes/zebra.ui.WinLayer.html">zebra.ui.WinLayer</a></li>
            
                <li><a href="../classes/zebra.ui.WinListener.html">zebra.ui.WinListener</a></li>
            
                <li><a href="../classes/zebra.ui.zCanvas.html">zebra.ui.zCanvas</a></li>
            
                <li><a href="../classes/zebra.URL.html">zebra.URL</a></li>
            
                <li><a href="../classes/zebra.util.Bag.html">zebra.util.Bag</a></li>
            
                <li><a href="../classes/zebra.util.findInTree().html">zebra.util.findInTree()</a></li>
            
                <li><a href="../classes/zebra.util.Listeners.html">zebra.util.Listeners</a></li>
            
                <li><a href="../classes/zebra.util.newInstance().html">zebra.util.newInstance()</a></li>
            
                <li><a href="../classes/zebra.util.Position.html">zebra.util.Position</a></li>
            
                <li><a href="../classes/zebra.util.Position.Metric.html">zebra.util.Position.Metric</a></li>
            
                <li><a href="../classes/zebra.util.rgb.html">zebra.util.rgb</a></li>
            
        </ul>
    </div>
</div>












        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>data.js</h4>

<pre class="code prettyprint linenums">
(function(pkg, Class, Interface) {

/**
 * Collection of variouse data models. 
 * @module data
 * @main 
 * @namespace zebra.data
 * @requires zebra, util
 */


/**
 * Text model interface
 * @class TextModel
 * @interface
*/

/**
 * Get the given string line stored in the model
 * @method getLine  
 * @param  {Integer} line a line number
 * @return {String}  a string line
 */

/**
 * Get wrapped by the text model original text string 
 * @method getValue
 * @return {String} an original text
 */

/**
 * Get number of lines stored in the text model
 * @method getLines
 * @return {Integer} a number of lines
 */

/**
 * Get number of characters stored in the model 
 * @method getTextLength
 * @return {Integer} a number of characters
 */

/**
 * Write the given string in the text model starting from the specified offset
 * @method write
 * @param  {String} s a string to be written into the text model 
 * @param  {Integer} offset an offset starting from that the passed string has to be written into the text model
 */

/**
 * Remove substring from the text model. 
 * @method remove
 * @param  {Integer} offset an offset starting from that a substring will be removed 
 * @param  {Integer} size a size of a substring to be removed 
 */

/**
 * Fill the text model with the given text  
 * @method  setValue
 * @param  {String} text a new text to be set for the text model
 */

/**
 * Fired when the text model has been updated: a string has been inserted or removed

        text._.add(function (src, b, off, len, startLine, lines) {
            ...
        });

 *
 * @event textUpdated 
 * @param {zebra.data.Text} src a text model that triggers the event
 * @param {Boolean}  b a flag that is true if a string has been written in the text model, false if the model substring has been removed
 * @param {Integer}  off an offset starting form that the text update took place
 * @param {Integer}  len a length of text that has been affected by the text model update
 * @param {Integer}  startLine a first line that has been affected by the text model update
 * @param {Integer}  lines a number of lines that has been affected by the text model update
 */
pkg.TextModel = Interface();


var MB = zebra.util;

function Line(s) {
    this.s = s;
    this.l = 0;
}

//  toString for array.join method
Line.prototype.toString = function() { return this.s; };

pkg.TextModelListeners = MB.Listeners.Class(&quot;textUpdated&quot;);

/**
 * Multi-lines text model implementation
 * @class Text
 * @param  {String}  [s] the specified text the model has to be filled
 * @constructor
 * @extends zebra.data.TextModel
 */
pkg.Text = Class(pkg.TextModel, [
    function $prototype() {
        this.textLength = 0;

        this.getLnInfo = function(lines, start, startOffset, o){
            for(; start &lt; lines.length; start++){
                var line = lines[start].s;
                if (o &gt;= startOffset &amp;&amp; o &lt;= startOffset + line.length) return [start, startOffset];
                startOffset += (line.length + 1);
            }
            return [];
        };

        this.setExtraChar = function(i,ch){ this.lines[i].l = ch; };
        
        this.getExtraChar = function (i) { return this.lines[i].l; };

        this.getLine = function(line) { return this.lines[line].s; };

        this.getValue = function(){ return this.lines.join(&quot;\n&quot;); };

        this.getLines = function () { return this.lines.length; };
        
        this.getTextLength = function() { return this.textLength; };

        this.write = function (s, offset){
            var slen = s.length, info = this.getLnInfo(this.lines, 0, 0, offset), line = this.lines[info[0]].s, j = 0,
                lineOff = offset - info[1], tmp = [line.substring(0, lineOff), s, line.substring(lineOff)].join(&#x27;&#x27;);

            for(; j &lt; slen &amp;&amp; s[j] != &#x27;\n&#x27;; j++);

            if(j &gt;= slen) {
                this.lines[info[0]].s = tmp;
                j = 1;
            }
            else {
                this.lines.splice(info[0], 1);
                j = this.parse(info[0], tmp, this.lines);
            }
            this.textLength += slen;
            this._.textUpdated(this, true, offset, slen, info[0], j);
        };

        this.remove = function (offset,size){
            var i1   = this.getLnInfo(this.lines, 0, 0, offset),
                i2   = this.getLnInfo(this.lines, i1[0], i1[1], offset + size),
                l2   = this.lines[i2[0]].s,
                l1   = this.lines[i1[0]].s,
                off1 = offset - i1[1], off2 = offset + size - i2[1],
                buf  = [l1.substring(0, off1), l2.substring(off2)].join(&#x27;&#x27;);

            if (i2[0] == i1[0]) this.lines.splice(i1[0], 1, new Line(buf));
            else {
                this.lines.splice(i1[0], i2[0] - i1[0] + 1);
                this.lines.splice(i1[0], 0, new Line(buf));
            }
            this.textLength -= size;
            this._.textUpdated(this, false, offset, size, i1[0], i2[0] - i1[0] + 1);
        };

        this.parse = function (startLine, text, lines){
            var size = text.length, prevIndex = 0, prevStartLine = startLine;
            for(var index = 0; index &lt;= size; prevIndex = index, startLine++){
                var fi = text.indexOf(&quot;\n&quot;, index);
                index = (fi &lt; 0 ? size : fi);
                this.lines.splice(startLine, 0, new Line(text.substring(prevIndex, index)));
                index++;
            }
            return startLine - prevStartLine;
        };

        this.setValue = function(text){
            if (text == null) throw new Error();
            var old = this.getValue();
            if (old !== text) {
                if (old.length &gt; 0) {
                    var numLines = this.getLines(), txtLen = this.getTextLength();
                    this.lines.length = 0;
                    this.lines = [ new Line(&quot;&quot;) ];
                    this._.textUpdated(this, false, 0, txtLen, 0, numLines);
                }

                this.lines = [];
                this.parse(0, text, this.lines);
                this.textLength = text.length;
                this._.textUpdated(this, true, 0, this.textLength, 0, this.getLines());
            }
        };

        this[&#x27;&#x27;] = function(s){
            this.lines = [ new Line(&quot;&quot;) ];
            this._ = new pkg.TextModelListeners();
            this.setValue(s == null ? &quot;&quot; : s);
        };
    }
]);

/**
 * Single line text model implementation
 * @param  {String}  [s] the specified text the model has to be filled
 * @param  {Integer} [max] the specified maximal text length
 * @constructor
 * @class SingleLineTxt
 * @extends zebra.data.TextModel
 */
pkg.SingleLineTxt = Class(pkg.TextModel, [
    function $prototype() {
        /**
         * Maximal text length. -1 means the text is not restricted regarding its length. 
         * @attribute maxLen
         * @type {Integer}
         * @default -1
         * @readOnly
         */

        this.setExtraChar = function(i,ch) { this.extra = ch; };
        this.getExtraChar = function(i){ return this.extra; };

        this.getValue = function(){ return this.buf; };

        /**
         * Get number of lines stored in the text model. The model can have only one line
         * @method getLines
         * @return {Integer} a number of lines
         */
        this.getLines = function(){ return 1; };

        this.getTextLength = function(){ return this.buf.length; };

        this.getLine = function(line){ 
            if (line != 0) throw new Error();
            return this.buf;
        };

        this.write = function(s,offset){
            var buf = this.buf, j = s.indexOf(&quot;\n&quot;);
            if (j &gt;= 0) s = s.substring(0, j);
            var l = (this.maxLen &gt; 0 &amp;&amp; (buf.length + s.length) &gt;= this.maxLen) ? this.maxLen - buf.length : s.length;
            if (l!==0) {
                this.buf = [buf.substring(0, offset), s.substring(0, l), buf.substring(offset)].join(&#x27;&#x27;);
                if (l &gt; 0) this._.textUpdated(this, true, offset, l, 0, 1);
            }
        };

        this.remove = function(offset,size){
            this.buf = [ this.buf.substring(0, offset), this.buf.substring(offset + size)].join(&#x27;&#x27;);
            this._.textUpdated(this, false, offset, size, 0, 1);
        };

        this.setValue = function(text){
            if (text == null) throw new Error();
            var i = text.indexOf(&#x27;\n&#x27;);
            if (i &gt;= 0) text = text.substring(0, i);
            if(this.buf == null || this.buf !== text) {
                if (this.buf != null &amp;&amp; this.buf.length &gt; 0) this._.textUpdated(this, false, 0, this.buf.length, 0, 1);
                if (this.maxLen &gt; 0 &amp;&amp; text.length &gt; this.maxLen) text = text.substring(0, this.maxLen);
                this.buf = text;
                this._.textUpdated(this, true, 0, text.length, 0, 1);
            }
        };

        /**
         * Set the given maximal length the text can have
         * @method setMaxLength
         * @param  {Integer} max a maximal length of text
         */
        this.setMaxLength = function (max){
            if(max != this.maxLen){
                this.maxLen = max;
                this.setValue(&quot;&quot;);
            }
        };

        this[&#x27;&#x27;] = function (s, max) {   
            this.maxLen = max == null ? -1 : max;
            this.buf = null;
            this.extra = 0;
            this._ = new pkg.TextModelListeners();
            this.setValue(s == null ? &quot;&quot; : s);
        };
    }
]);

pkg.ListModelListeners = MB.Listeners.Class(&quot;elementInserted&quot;, &quot;elementRemoved&quot;, &quot;elementSet&quot;);

/**
 * List model class
 * @param  {Array} [a] an array the list model has to be initialized with
 
      // create list model that contains three integer elements
      var l = new zebra.data.ListModel([1,2,3]);
 
 * @constructor 
 * @class ListModel
 */

 /**
  * Fired when a new element has been added to the list model 

     list._.add(function elementInserted(src, o, i) {
         ...
     });

  * @event elementInserted 
  * @param {zebra.data.ListModel} src a list model that triggers the event
  * @param {Object}  o an element that has been added
  * @param {Integer} i an index at that the new element has been added
  */

 /**
  * Fired when an element has been removed from the list model 

     list._.add(function elementRemoved(src, o, i) {
         ...
     });

  * @event elementRemoved
  * @param {zebra.data.ListModel} src a list model that triggers the event
  * @param {Object}  o an element that has been removed
  * @param {Integer} i an index at that the element has been removed
  */

 /**
  * Fired when an element has been re-set 

     list._.add(function elementSet(src, o, pe, i) {
         ...
     });

  * @event elementSet
  * @param {zebra.data.ListModel} src a list model that triggers the event
  * @param {Object}  o an element that has been set
  * @param {Object}  pe a previous element 
  * @param {Integer} i an index at that the element has been re-set
  */

pkg.ListModel = Class([
    function $prototype() {
        /**
         * Get an item stored at the given location in the list 
         * @method get
         * @param  {Integer} i an item location
         * @return {object}  a list item
         */
        this.get = function(i) {
            if (i &lt; 0 || i &gt;= this.d.length) throw new Error(&quot;Invalid list model index: &quot; + i);
            return this.d[i];
        };

        /**
         * Add the given item into end of the list 
         * @method add
         * @param  {Object} o an item to be added
         */
        this.add = function(o) {
            this.d.push(o);
            this._.elementInserted(this, o, this.d.length - 1);
        };

        /**
         * Remove all elements from the list model
         * @method removeAll
         */
        this.removeAll = function() {
            var size = this.d.length;
            for(var i = size - 1; i &gt;= 0; i--) this.removeAt(i);
        };

        /**
         * Remove an element at the given location of the list model
         * @method removeAt
         * @param {Integer} i a location of an element to be removed from the list
         */
        this.removeAt = function(i) {
            var re = this.d[i];
            this.d.splice(i, 1);
            this._.elementRemoved(this, re, i);
        };

        /**
         * Remove the given element from the list
         * @method remove
         * @param {Object} o an element to be removed from the list
         */
        this.remove = function(o) {
            for(var i = 0;i &lt; this.d.length; i++ ) if (this.d[i] === o) this.removeAt(i);
        };

        /**
         * Insert the given element into the given position of the list
         * @method insert
         * @param {Object} o an element to be inserted into the list
         * @param {Integer} i a position at which the element has to be inserted into the list 
         */
        this.insert = function(o,i){
            if(i &lt; 0 || i &gt;= this.d.length) throw new Error();
            this.d.splice(i, 0, o);
            this._.elementInserted(this, o, i);
        };

        /**
         * Get number of elements stored in the list
         * @method count
         * @return {Integer} a number of element in the list
         */
        this.count = function () { return this.d.length; };

        /**
         * Set the new element at the given position
         * @method set
         * @param  {Object} o a new element to be set as the list element at the given position
         * @param  {Integer} i a position
         * @return {Object}  previous element that was stored at the given position
         */
        this.set = function (o,i){
            if (i &lt; 0 || i &gt;= this.d.length) throw new Error(&quot;&quot; + i);
            var pe = this.d[i];
            this.d[i] = o;
            this._.elementSet(this, o, pe, i);
            return pe;
        };

        /**
         * Check if the element is in the list
         * @method contains
         * @param  {Object} o an element to be checked 
         * @return {Boolean} true if the element is in the list  
         */
        this.contains = function (o){ return this.indexOf(o) &gt;= 0; };

        /**
         * Get position the given element is stored in the list
         * @method indexOf
         * @param  {Object} o an element 
         * @return {Integer} the element position. -1 if the element cannot be found in the list 
         */
        this.indexOf = function(o){ return this.d.indexOf(o); };

        this[&#x27;&#x27;] = function() {
            this._ = new pkg.ListModelListeners();
            this.d = (arguments.length === 0) ? [] : arguments[0];
        };
    }
]);

/**
 * Tree model item class. The structure is used by tree model to store tree items values, parent and children item references.
 * @class Item
 * @param  {Object} [v] the item value
 * @constructor 
 */
var Item = pkg.Item = Class([
    function $prototype() {
        this[&#x27;&#x27;] = function(v) {
            /**
             * Array of the element children items
             * @attribute kids
             * @type {Array}
             * @default []
             * @readOnly
             */
            this.kids = [];

            /**
             * Value stored with this item
             * @attribute value
             * @type {Object}
             * @default null
             * @readOnly
             */
            this.value = v;

            /**
             * Reference to parent item
             * @attribute parent
             * @type {zebra.data.Item}
             * @default undefined
             * @readOnly
             */
        };
    }
]);

pkg.TreeModelListeners = MB.Listeners.Class(&quot;itemModified&quot;, &quot;itemRemoved&quot;, &quot;itemInserted&quot;);


/**
 * Tree model class. The class is simple and handy way to keep hierarchical structure. 
 * @constructor
 * @param  {zebra.data.Item|Object} [r] a root item. As the argument you can pass &quot;zebra.data.Item&quot; or
 * a JavaType object. In the second case you can describe the tree as follow:

     // create tree model initialized with tree structure passed as 
     // special formated JavaScript object   
     var tree = new zebra.data.TreeModel({ value:&quot;Root&quot;,
                                          kids: [
                                              &quot;Root kid 1&quot;,
                                              { 
                                                value: &quot;Root kid 2&quot;,
                                                kids:  [ &quot;Kid of kid 2&quot;] 
                                              }
                                          ] });

 * @class TreeModel
 */

/**
 * Fired when the tree model item value has been updated. 

    tree._.add(function itemModified(src, item) {
        ...
    });

 * @event itemModified 
 * @param {zebra.data.TreeModel} src a tree model that triggers the event
 * @param {zebra.data.Item}  item an item whose value has been updated
 */

/**
 * Fired when the tree model item has been removed

    tree._.add(function itemRemoved(src, item) {
       ...
    });

 * @event itemRemoved
 * @param {zebra.data.TreeModel} src a tree model that triggers the event
 * @param {zebra.data.Item}  item an item that has been removed from the tree model
 */

/**
 * Fired when the tree model item has been inserted into the model

    tree._.add(function itemInserted(src, item) {
       ...
    });

 * @event itemInserted
 * @param {zebra.data.TreeModel} src a tree model that triggers the event
 * @param {zebra.data.Item}  item an item that has been inserted into the tree model
 */

pkg.TreeModel = Class([
    function $clazz() {
        this.create = function(r, p) {
            var item = new Item(r.hasOwnProperty(&quot;value&quot;)? r.value : r);
            item.parent = p;
            if (r.hasOwnProperty(&quot;kids&quot;)) {
                for(var i = 0; i &lt; r.kids.length; i++) {
                    item.kids[i] = pkg.TreeModel.create(r.kids[i], item);
                }
            }
            return item;
        };
    },

    function $prototype() {
        /**
         * Reference to teh tree model root item
         * @attribute root
         * @readOnly
         */

        /**
         * Update a value of the given tree model item with the new one
         * @method setValue
         * @param  {zebra.data.Item} item an item whose value has to be updated
         * @param  {[type]} v   a new item value
         */
        this.setValue = function(item, v){
            item.value = v;
            this._.itemModified(this, item);
        };

        /**
         * Add the new item to the tree model as a children element of the given parent item
         * @method add
         * @param  {zebra.data.Item} to a parent item to which the new item has to be added
         * @param  {Object|zebra.data.Item} an item or value of the item to be added to the parent item of the tree model 
         */
        this.add = function(to,item){
            this.insert(to, item, to.kids.length);
        };

        /**
         * Insert the new item to the tree model as a children element at the given position of the parent element
         * @method insert
         * @param  {zebra.data.Item} to a parent item to which the new item has to be inserted
         * @param  {Object|zebra.data.Item} an item or value of the item to be inserted to the parent item
         * @param  {Integer} i a position the new item has to be inserted into the parent item
         */
        this.insert = function(to,item,i){
            if (i &lt; 0 || to.kids.length &lt; i) throw new Error(&quot;Illegal index : &quot; + i);
            if (zebra.isString(item)) {
                item = new Item(item);
            }
            to.kids.splice(i, 0, item);
            item.parent = to;
            this._.itemInserted(this, item);

            // !!!
            // it is necessary to analyze if the inserted item has kids and
            // generate inserted event for all kids recursively
        };

        /**
         * Remove the given item from the tree model
         * @method remove
         * @param  {zebra.data.Item} item an item to be removed from the tree model
         */
        this.remove = function(item){
            if (item == this.root) this.root = null;
            else {
                for(var i=0; i &lt; item.kids.length; i++) this.remove(item.kids[i]);
                item.parent.kids.splice(item.parent.kids.indexOf(item), 1);
                item.parent = null;
            }
            this._.itemRemoved(this, item);
        };

        /**
         * Remove all children items from the given item of the tree model
         * @method removeKids
         * @param  {zebra.data.Item} item an item from that all children items have to be removed
         */
        this.removeKids = function(item){
            for(var i = 0; i &lt; items.kids.length; i++) this.remove(items[i]);
        };

        this[&#x27;&#x27;] = function(r) {
            if (arguments.length === 0) r = new Item();
            this.root = zebra.instanceOf(r, Item) ? r : pkg.TreeModel.create(r);
            this._ = new pkg.TreeModelListeners();
        };
    }
]);

pkg.MatrixListeners = MB.Listeners.Class(&quot;matrixResized&quot;, &quot;cellModified&quot;);

/**
 *  Matrix model class. 
 *  @constructor
 *  @param  {Array of Array} [data] the given data 
 *  @param  {Interger} [rows] a number of rows
 *  @param  {Interger} [cols] a number of columns
 *  @class Matrix
 */
pkg.Matrix = Class([
    function $prototype() {
        /**
         * Number of rows in the matrix model
         * @attribute rows
         * @type {Integer}
         * @readOnly
         */

        /**
         * Number of columns in the matrix model
         * @attribute cols
         * @type {Integer}
         * @readOnly
         */
        
        /**
         * Fired when the matrix model size (number of rows or columns) is changed. 
          
         matrix._.add(function matrixResized(src, pr, pc) {
            ...
         });
          
         * @event matrixResized 
         * @param {zebra.data.Matrix} src a matrix that triggers the event
         * @param {Integer}  pr a previous number of rows 
         * @param {Integer}  pc a previous number of columns 
         */

         /**
          * Fired when the matrix model cell has been updated. 
          
          matrix._.add(function cellModified(src, row, col, old) {
             ...
          });

          * @event cellModified 
          * @param {zebra.data.Matrix} src a matrix that triggers the event
          * @param {Integer}  row an updated row 
          * @param {Integer}  col an updated column 
          * @param {Object}  old a previous cell value
          */
       

        /**
         * Get a matrix model cell value at the specified row and column
         * @method get
         * @param  {Integer} row a cell row
         * @param  {Integer} col a cell column
         * @return {Object}  matrix model cell value
         */
        this.get = function (row,col){
            if (row &lt; 0 || row &gt;= this.rows || col &lt; 0 || col &gt;= this.cols) {
                throw new Error();
            }
            return this.objs[row][col];
        };

        /**
         * Set the specified by row and column cell value. If the specified row or column is greater than 
         * the matrix model has the model size will be adjusted to new one. 
         * @method put
         * @param  {Integer} row a cell row
         * @param  {Integer} col a cell column
         * @param  {Object} obj a new cell value
         */
        this.put = function(row,col,obj){
            if (arguments.length != 3) throw new Error();
            var nr = this.rows, nc = this.cols;
            if(row &gt;= nr) nr += (row - nr + 1);
            if(col &gt;= nc) nc += (col - nc + 1);
            this.setRowsCols(nr, nc);
            var old = this.objs[row] ? this.objs[row][col] : undefined;
            if (obj != old) {
                this.objs[row][col] = obj;
                this._.cellModified(this, row, col, old);
            }
        };

        /**
         * Set the specified by index cell value. The index identifies cell starting from [0,0] cell till [rows,columns]. 
         * If the index is greater than size of model the model size will be adjusted to new one.   
         * @method puti
         * @param  {Integer} i a cell row
         * @param  {Object} obj a new cell value
         */
        this.puti = function(i, obj){
            var p = zebra.util.index2point(i, this.cols);
            this.put(p[0], p[1], obj);
        };

        /**
         * Set the given number of rows and columns the model has to have.
         * @method setRowsCols
         * @param  {Integer} rows a new number of rows
         * @param  {Integer} cols a new number of columns
         */
        this.setRowsCols = function(rows, cols){
            if(rows != this.rows || cols != this.cols){
                var pc = this.cols, pr = this.rows;
                this.rellocate(rows, cols);
                this.cols = cols;
                this.rows = rows;
                this._.matrixResized(this, pr, pc);
            }
        };

        /**
         * Reallocate the matrix model space with the new number of rows and columns 
         * @method rellocate
         * @private
         * @param  {Integer} r a new number of rows
         * @param  {Integer} c a new number of columns
         */
        this.rellocate = function(r, c) {
            if (r &gt;= this.rows) {
                for(var i=this.rows; i &lt; r; i++)  this.objs[i] = [];
            }
        };

         /**
         * Set the given number of rows the model has to have.
         * @method setRows
         * @param  {Integer} rows a new number of rows
         */
        this.setRows = function(rows) { this.setRowsCols(rows, this.cols); };

        /**
         * Set the given number of columns the model has to have.
         * @method setCols
         * @param  {Integer} cols a new number of columns
         */
        this.setCols = function(cols) { this.setRowsCols(this.rows, cols); };

        /**
         * Remove specified number of rows from the model starting from the given row.
         * @method removeRows
         * @param  {Integer}  begrow a start row 
         * @param  {Interger} count  a number of rows to be removed
         */
        this.removeRows = function(begrow,count){
            if (begrow &lt; 0 || begrow + count &gt; this.rows) throw new Error();
            for(var i = (begrow + count);i &lt; this.rows; i++, begrow++){
                for(var j = 0;j &lt; this.cols; j ++ ){
                    this.objs[begrow][j] = this.objs[i][j];
                    this.objs[i][j] = null;
                }
            }
            this.rows -= count;
            this._.matrixResized(this, this.rows + count, this.cols);
        };

        /**
         * Remove specified number of columns from the model starting from the given column.
         * @method removeCols
         * @param  {Integer}  begcol a start column
         * @param  {Interger} count  a number of columns to be removed
         */
        this.removeCols = function (begcol,count){
            if (begcol &lt; 0 || begcol + count &gt; this.cols) throw new Error();
            for(var i = (begcol + count);i &lt; this.cols; i++, begcol++){
                for(var j = 0;j &lt; this.rows; j++){
                    this.objs[j][begcol] = this.objs[j][i];
                    this.objs[j][i] = null;
                }
            }
            this.cols -= count;
            this._.matrixResized(this, this.rows, this.cols + count);
        };

        this[&#x27;&#x27;] = function() {
            this._ = new pkg.MatrixListeners();
            if (arguments.length == 1) {
                this.objs = arguments[0];
                this.cols = (this.objs.length &gt; 0) ? this.objs[0].length : 0;
                this.rows = this.objs.length;
            }
            else {
                this.objs = [];
                this.rows = this.cols = 0;
                if (arguments.length &gt; 1) {
                    this.setRowsCols(arguments[0], arguments[1]);
                }
            }
        };
    }
]);

})(zebra(&quot;data&quot;), zebra.Class, zebra.Interface);
</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
