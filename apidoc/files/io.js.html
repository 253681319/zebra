<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>io.js - Zebra API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1>Zebra API: io.js</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 07/2013</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Packages</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/data.html">data</a>
                
                </li>
            
                <li><a href="../modules/io.html">io</a>
                
                </li>
            
                <li><a href="../modules/layout.html">layout</a>
                
                </li>
            
                <li><a href="../modules/ui.html">ui</a>
                
                </li>
            
                <li><a href="../modules/ui.designer.html">ui.designer</a>
                
                </li>
            
                <li><a href="../modules/ui.grid.html">ui.grid</a>
                
                </li>
            
                <li><a href="../modules/ui.tree.html">ui.tree</a>
                
                </li>
            
                <li><a href="../modules/util.html">util</a>
                
                </li>
            
                <li><a href="../modules/zebra.html">zebra</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Classes and interfaces</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/zebra.Class().html">zebra.Class()</a></li>
            
                <li><a href="../classes/zebra.data.Item.html">zebra.data.Item</a></li>
            
                <li><a href="../classes/zebra.data.ListModel.html">zebra.data.ListModel</a></li>
            
                <li><a href="../classes/zebra.data.Matrix.html">zebra.data.Matrix</a></li>
            
                <li><a href="../classes/zebra.data.SingleLineTxt.html">zebra.data.SingleLineTxt</a></li>
            
                <li><a href="../classes/zebra.data.Text.html">zebra.data.Text</a></li>
            
                <li><a href="../classes/zebra.data.TextModel.html">zebra.data.TextModel</a></li>
            
                <li><a href="../classes/zebra.data.TreeModel.html">zebra.data.TreeModel</a></li>
            
                <li><a href="../classes/zebra.Dummy.html">zebra.Dummy</a></li>
            
                <li><a href="../classes/zebra.forName().html">zebra.forName()</a></li>
            
                <li><a href="../classes/zebra.instanceOf().html">zebra.instanceOf()</a></li>
            
                <li><a href="../classes/zebra.Interface().html">zebra.Interface()</a></li>
            
                <li><a href="../classes/zebra.io.b64decode().html">zebra.io.b64decode()</a></li>
            
                <li><a href="../classes/zebra.io.b64encode().html">zebra.io.b64encode()</a></li>
            
                <li><a href="../classes/zebra.io.GET().html">zebra.io.GET()</a></li>
            
                <li><a href="../classes/zebra.io.HTTP.html">zebra.io.HTTP</a></li>
            
                <li><a href="../classes/zebra.io.ID().html">zebra.io.ID()</a></li>
            
                <li><a href="../classes/zebra.io.JRPC.html">zebra.io.JRPC</a></li>
            
                <li><a href="../classes/zebra.io.JRPC.invoke().html">zebra.io.JRPC.invoke()</a></li>
            
                <li><a href="../classes/zebra.io.POST().html">zebra.io.POST()</a></li>
            
                <li><a href="../classes/zebra.io.QS.html">zebra.io.QS</a></li>
            
                <li><a href="../classes/zebra.io.Service.html">zebra.io.Service</a></li>
            
                <li><a href="../classes/zebra.io.XRPC.html">zebra.io.XRPC</a></li>
            
                <li><a href="../classes/zebra.io.XRPC.invoke().html">zebra.io.XRPC.invoke()</a></li>
            
                <li><a href="../classes/zebra.layout.BorderLayout.html">zebra.layout.BorderLayout</a></li>
            
                <li><a href="../classes/zebra.layout.Constraints.html">zebra.layout.Constraints</a></li>
            
                <li><a href="../classes/zebra.layout.FlowLayout.html">zebra.layout.FlowLayout</a></li>
            
                <li><a href="../classes/zebra.layout.getAbsLocation().html">zebra.layout.getAbsLocation()</a></li>
            
                <li><a href="../classes/zebra.layout.getDirectAt().html">zebra.layout.getDirectAt()</a></li>
            
                <li><a href="../classes/zebra.layout.getDirectChild().html">zebra.layout.getDirectChild()</a></li>
            
                <li><a href="../classes/zebra.layout.getTopParent().html">zebra.layout.getTopParent()</a></li>
            
                <li><a href="../classes/zebra.layout.GridLayout.html">zebra.layout.GridLayout</a></li>
            
                <li><a href="../classes/zebra.layout.Layout.html">zebra.layout.Layout</a></li>
            
                <li><a href="../classes/zebra.layout.Layoutable.html">zebra.layout.Layoutable</a></li>
            
                <li><a href="../classes/zebra.layout.ListLayout.html">zebra.layout.ListLayout</a></li>
            
                <li><a href="../classes/zebra.layout.PercentLayout.html">zebra.layout.PercentLayout</a></li>
            
                <li><a href="../classes/zebra.layout.RasterLayout.html">zebra.layout.RasterLayout</a></li>
            
                <li><a href="../classes/zebra.layout.StackLayout.html">zebra.layout.StackLayout</a></li>
            
                <li><a href="../classes/zebra.ready().html">zebra.ready()</a></li>
            
                <li><a href="../classes/zebra.ui.BaseLayer.html">zebra.ui.BaseLayer</a></li>
            
                <li><a href="../classes/zebra.ui.BaseList.html">zebra.ui.BaseList</a></li>
            
                <li><a href="../classes/zebra.ui.BoldLabel.html">zebra.ui.BoldLabel</a></li>
            
                <li><a href="../classes/zebra.ui.Border.html">zebra.ui.Border</a></li>
            
                <li><a href="../classes/zebra.ui.BorderPan.html">zebra.ui.BorderPan</a></li>
            
                <li><a href="../classes/zebra.ui.Button.html">zebra.ui.Button</a></li>
            
                <li><a href="../classes/zebra.ui.Checkbox.html">zebra.ui.Checkbox</a></li>
            
                <li><a href="../classes/zebra.ui.Checkbox.Box.html">zebra.ui.Checkbox.Box</a></li>
            
                <li><a href="../classes/zebra.ui.ChildrenListener.html">zebra.ui.ChildrenListener</a></li>
            
                <li><a href="../classes/zebra.ui.Combo.html">zebra.ui.Combo</a></li>
            
                <li><a href="../classes/zebra.ui.Combo.ContentPan.html">zebra.ui.Combo.ContentPan</a></li>
            
                <li><a href="../classes/zebra.ui.Combo.EditableContentPan.html">zebra.ui.Combo.EditableContentPan</a></li>
            
                <li><a href="../classes/zebra.ui.Combo.ReadonlyContentPan.html">zebra.ui.Combo.ReadonlyContentPan</a></li>
            
                <li><a href="../classes/zebra.ui.ComboArrowView.html">zebra.ui.ComboArrowView</a></li>
            
                <li><a href="../classes/zebra.ui.CommandManager.html">zebra.ui.CommandManager</a></li>
            
                <li><a href="../classes/zebra.ui.CompList.html">zebra.ui.CompList</a></li>
            
                <li><a href="../classes/zebra.ui.ComponentListener.html">zebra.ui.ComponentListener</a></li>
            
                <li><a href="../classes/zebra.ui.Composite.html">zebra.ui.Composite</a></li>
            
                <li><a href="../classes/zebra.ui.CompositeView.html">zebra.ui.CompositeView</a></li>
            
                <li><a href="../classes/zebra.ui.CompRender.html">zebra.ui.CompRender</a></li>
            
                <li><a href="../classes/zebra.ui.CopyCutPaste.html">zebra.ui.CopyCutPaste</a></li>
            
                <li><a href="../classes/zebra.ui.Cursorable.html">zebra.ui.Cursorable</a></li>
            
                <li><a href="../classes/zebra.ui.CursorManager.html">zebra.ui.CursorManager</a></li>
            
                <li><a href="../classes/zebra.ui.designer.ShaperPan.html">zebra.ui.designer.ShaperPan</a></li>
            
                <li><a href="../classes/zebra.ui.Dotted.html">zebra.ui.Dotted</a></li>
            
                <li><a href="../classes/zebra.ui.Etched.html">zebra.ui.Etched</a></li>
            
                <li><a href="../classes/zebra.ui.EventManager.html">zebra.ui.EventManager</a></li>
            
                <li><a href="../classes/zebra.ui.findCanvas().html">zebra.ui.findCanvas()</a></li>
            
                <li><a href="../classes/zebra.ui.FocusListener.html">zebra.ui.FocusListener</a></li>
            
                <li><a href="../classes/zebra.ui.FocusManager.html">zebra.ui.FocusManager</a></li>
            
                <li><a href="../classes/zebra.ui.Font.html">zebra.ui.Font</a></li>
            
                <li><a href="../classes/zebra.ui.Gradient.html">zebra.ui.Gradient</a></li>
            
                <li><a href="../classes/zebra.ui.grid.DefEditors.html">zebra.ui.grid.DefEditors</a></li>
            
                <li><a href="../classes/zebra.ui.grid.Grid.html">zebra.ui.grid.Grid</a></li>
            
                <li><a href="../classes/zebra.ui.grid.GridCaption.html">zebra.ui.grid.GridCaption</a></li>
            
                <li><a href="../classes/zebra.ui.grid.GridStretchPan.html">zebra.ui.grid.GridStretchPan</a></li>
            
                <li><a href="../classes/zebra.ui.grid.Metrics.html">zebra.ui.grid.Metrics</a></li>
            
                <li><a href="../classes/zebra.ui.Group.html">zebra.ui.Group</a></li>
            
                <li><a href="../classes/zebra.ui.HtmlElement.html">zebra.ui.HtmlElement</a></li>
            
                <li><a href="../classes/zebra.ui.HtmlTextArea.html">zebra.ui.HtmlTextArea</a></li>
            
                <li><a href="../classes/zebra.ui.HtmlTextField.html">zebra.ui.HtmlTextField</a></li>
            
                <li><a href="../classes/zebra.ui.HtmlTextInput.html">zebra.ui.HtmlTextInput</a></li>
            
                <li><a href="../classes/zebra.ui.ImageLabel.html">zebra.ui.ImageLabel</a></li>
            
                <li><a href="../classes/zebra.ui.ImagePan.html">zebra.ui.ImagePan</a></li>
            
                <li><a href="../classes/zebra.ui.InputEvent.html">zebra.ui.InputEvent</a></li>
            
                <li><a href="../classes/zebra.ui.KeyEvent.html">zebra.ui.KeyEvent</a></li>
            
                <li><a href="../classes/zebra.ui.KeyListener.html">zebra.ui.KeyListener</a></li>
            
                <li><a href="../classes/zebra.ui.Label.html">zebra.ui.Label</a></li>
            
                <li><a href="../classes/zebra.ui.List.html">zebra.ui.List</a></li>
            
                <li><a href="../classes/zebra.ui.List.ViewProvider.html">zebra.ui.List.ViewProvider</a></li>
            
                <li><a href="../classes/zebra.ui.loadImage().html">zebra.ui.loadImage()</a></li>
            
                <li><a href="../classes/zebra.ui.Manager.html">zebra.ui.Manager</a></li>
            
                <li><a href="../classes/zebra.ui.Menu.html">zebra.ui.Menu</a></li>
            
                <li><a href="../classes/zebra.ui.Menunbar.html">zebra.ui.Menunbar</a></li>
            
                <li><a href="../classes/zebra.ui.MLabel.html">zebra.ui.MLabel</a></li>
            
                <li><a href="../classes/zebra.ui.MouseEvent.html">zebra.ui.MouseEvent</a></li>
            
                <li><a href="../classes/zebra.ui.MouseListener.html">zebra.ui.MouseListener</a></li>
            
                <li><a href="../classes/zebra.ui.MouseWheelSupport.html">zebra.ui.MouseWheelSupport</a></li>
            
                <li><a href="../classes/zebra.ui.PaintManager.html">zebra.ui.PaintManager</a></li>
            
                <li><a href="../classes/zebra.ui.PaintManImpl.html">zebra.ui.PaintManImpl</a></li>
            
                <li><a href="../classes/zebra.ui.Panel.html">zebra.ui.Panel</a></li>
            
                <li><a href="../classes/zebra.ui.PasswordText.html">zebra.ui.PasswordText</a></li>
            
                <li><a href="../classes/zebra.ui.Pattern.html">zebra.ui.Pattern</a></li>
            
                <li><a href="../classes/zebra.ui.Picture.html">zebra.ui.Picture</a></li>
            
                <li><a href="../classes/zebra.ui.PopupInfo.html">zebra.ui.PopupInfo</a></li>
            
                <li><a href="../classes/zebra.ui.PopupLayer.html">zebra.ui.PopupLayer</a></li>
            
                <li><a href="../classes/zebra.ui.PopupManager.html">zebra.ui.PopupManager</a></li>
            
                <li><a href="../classes/zebra.ui.Progress.html">zebra.ui.Progress</a></li>
            
                <li><a href="../classes/zebra.ui.Radial.html">zebra.ui.Radial</a></li>
            
                <li><a href="../classes/zebra.ui.Radiobox.html">zebra.ui.Radiobox</a></li>
            
                <li><a href="../classes/zebra.ui.RadioView.html">zebra.ui.RadioView</a></li>
            
                <li><a href="../classes/zebra.ui.Raised.html">zebra.ui.Raised</a></li>
            
                <li><a href="../classes/zebra.ui.Render.html">zebra.ui.Render</a></li>
            
                <li><a href="../classes/zebra.ui.RootLayer.html">zebra.ui.RootLayer</a></li>
            
                <li><a href="../classes/zebra.ui.RoundBorder.html">zebra.ui.RoundBorder</a></li>
            
                <li><a href="../classes/zebra.ui.Scroll.html">zebra.ui.Scroll</a></li>
            
                <li><a href="../classes/zebra.ui.ScrollManager.html">zebra.ui.ScrollManager</a></li>
            
                <li><a href="../classes/zebra.ui.ScrollPan.html">zebra.ui.ScrollPan</a></li>
            
                <li><a href="../classes/zebra.ui.Slider.html">zebra.ui.Slider</a></li>
            
                <li><a href="../classes/zebra.ui.SplitPan.html">zebra.ui.SplitPan</a></li>
            
                <li><a href="../classes/zebra.ui.StatePan.html">zebra.ui.StatePan</a></li>
            
                <li><a href="../classes/zebra.ui.Sunken.html">zebra.ui.Sunken</a></li>
            
                <li><a href="../classes/zebra.ui.SwitchManager.html">zebra.ui.SwitchManager</a></li>
            
                <li><a href="../classes/zebra.ui.Tabs.html">zebra.ui.Tabs</a></li>
            
                <li><a href="../classes/zebra.ui.TextArea.html">zebra.ui.TextArea</a></li>
            
                <li><a href="../classes/zebra.ui.TextField.html">zebra.ui.TextField</a></li>
            
                <li><a href="../classes/zebra.ui.TextRender.html">zebra.ui.TextRender</a></li>
            
                <li><a href="../classes/zebra.ui.Toolbar.html">zebra.ui.Toolbar</a></li>
            
                <li><a href="../classes/zebra.ui.TooltipInfo.html">zebra.ui.TooltipInfo</a></li>
            
                <li><a href="../classes/zebra.ui.TooltipManager.html">zebra.ui.TooltipManager</a></li>
            
                <li><a href="../classes/zebra.ui.tree.DefEditors.html">zebra.ui.tree.DefEditors</a></li>
            
                <li><a href="../classes/zebra.ui.tree.DefViews.html">zebra.ui.tree.DefViews</a></li>
            
                <li><a href="../classes/zebra.ui.tree.Tree.html">zebra.ui.tree.Tree</a></li>
            
                <li><a href="../classes/zebra.ui.View.html">zebra.ui.View</a></li>
            
                <li><a href="../classes/zebra.ui.ViewPan.html">zebra.ui.ViewPan</a></li>
            
                <li><a href="../classes/zebra.ui.ViewSet.html">zebra.ui.ViewSet</a></li>
            
                <li><a href="../classes/zebra.ui.Window.html">zebra.ui.Window</a></li>
            
                <li><a href="../classes/zebra.ui.WinLayer.html">zebra.ui.WinLayer</a></li>
            
                <li><a href="../classes/zebra.ui.WinListener.html">zebra.ui.WinListener</a></li>
            
                <li><a href="../classes/zebra.ui.zCanvas.html">zebra.ui.zCanvas</a></li>
            
                <li><a href="../classes/zebra.URL.html">zebra.URL</a></li>
            
                <li><a href="../classes/zebra.util.Bag.html">zebra.util.Bag</a></li>
            
                <li><a href="../classes/zebra.util.findInTree().html">zebra.util.findInTree()</a></li>
            
                <li><a href="../classes/zebra.util.Listeners.html">zebra.util.Listeners</a></li>
            
                <li><a href="../classes/zebra.util.newInstance().html">zebra.util.newInstance()</a></li>
            
                <li><a href="../classes/zebra.util.Position.html">zebra.util.Position</a></li>
            
                <li><a href="../classes/zebra.util.Position.Metric.html">zebra.util.Position.Metric</a></li>
            
                <li><a href="../classes/zebra.util.rgb.html">zebra.util.rgb</a></li>
            
        </ul>
    </div>
</div>












        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>io.js</h4>

<pre class="code prettyprint linenums">
(function(pkg, Class) {

/**
 * @module io
 * @namespace zebra.io
 * @requires zebra, util
 */


var HEX = &quot;0123456789ABCDEF&quot;;

/**
 * Generate UUID of the given length
 * @param {Ineteger} [size] the generated UUID length. The default size is 16 characters.
 * @return {String} an UUID
 * @method  ID
 * @for  ID()
 */
pkg.ID = function UUID(size) {
    if (typeof size === &#x27;undefined&#x27;) size = 16;
    var id = [];
    for (var i=0; i&lt;36; i++)  id[i] = HEX[~~(Math.random() * 16)];
    return id.join(&#x27;&#x27;);
};
/**
 * @for  ID()
 */

pkg.sleep = function() {
    var r = new XMLHttpRequest(), t = (new Date()).getTime().toString(), i = window.location.toString().lastIndexOf(&quot;?&quot;);
    r.open(&#x27;GET&#x27;, window.location + (i &gt; 0 ? &quot;&amp;&quot; : &quot;?&quot;) + t, false);
    r.send(null);
};

// !!!
// b64 is supposed to be used with binary stuff, applying it to utf-8 encoded data can bring to error
// !!!
var b64str = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;;

/**
 * Encode the given string into base64
 * @param  {String} input a string to be encoded
 * @method  b64encode
 * @for  b64encode()
 */
pkg.b64encode = function(input) {
    var out = [], i = 0, len = input.length, c1, c2, c3;
    if (typeof ArrayBuffer !== &quot;undefined&quot;) {
        if (input instanceof ArrayBuffer) input = new Uint8Array(input);
        input.charCodeAt = function(i) { return this[i]; };
    }
    if (Array.isArray(input)) input.charCodeAt = function(i) { return this[i]; };

    while(i &lt; len) {
        c1 = input.charCodeAt(i++) &amp; 0xff;
        out.push(b64str.charAt(c1 &gt;&gt; 2));
        if (i == len) {
            out.push(b64str.charAt((c1 &amp; 0x3) &lt;&lt; 4), &quot;==&quot;);
            break;
        }
        c2 = input.charCodeAt(i++);
        out.push(b64str.charAt(((c1 &amp; 0x3) &lt;&lt; 4) | ((c2 &amp; 0xF0) &gt;&gt; 4)));
        if (i == len) {
            out.push(b64str.charAt((c2 &amp; 0xF) &lt;&lt; 2), &quot;=&quot;);
            break;
        }
        c3 = input.charCodeAt(i++);
        out.push(b64str.charAt(((c2 &amp; 0xF) &lt;&lt; 2) | ((c3 &amp; 0xC0) &gt;&gt; 6)), b64str.charAt(c3 &amp; 0x3F));
    }
    return out.join(&#x27;&#x27;);
};
/**
 * @for b64encode()
 */

/**
 * Decode the base64 encoded string
 * @param {String} input base64 encoded string
 * @return {String} a string
 * @for b64decode()
 * @method b64decode
 */
pkg.b64decode = function(input) {
    var output = [], chr1, chr2, chr3, enc1, enc2, enc3, enc4;
    input = input.replace(/[^A-Za-z0-9\+\/\=]/g, &quot;&quot;);

    while ((input.length % 4) !== 0) input += &quot;=&quot;;

    for(var i=0; i &lt; input.length;) {
        enc1 = b64str.indexOf(input.charAt(i++));
        enc2 = b64str.indexOf(input.charAt(i++));
        enc3 = b64str.indexOf(input.charAt(i++));
        enc4 = b64str.indexOf(input.charAt(i++));

        chr1 = (enc1 &lt;&lt; 2) | (enc2 &gt;&gt; 4);
        chr2 = ((enc2 &amp; 15) &lt;&lt; 4) | (enc3 &gt;&gt; 2);
        chr3 = ((enc3 &amp; 3) &lt;&lt; 6) | enc4;
        output.push(String.fromCharCode(chr1));
        if (enc3 != 64) output.push(String.fromCharCode(chr2));
        if (enc4 != 64) output.push(String.fromCharCode(chr3));
    }
    return output.join(&#x27;&#x27;);
};
/**
 * @for b64decode()
 */

pkg.dateToISO8601 = function(d) {
    function pad(n) { return n &lt; 10 ? &#x27;0&#x27;+n : n; }
    return [ d.getUTCFullYear(), &#x27;-&#x27;, pad(d.getUTCMonth()+1), &#x27;-&#x27;, pad(d.getUTCDate()), &#x27;T&#x27;, pad(d.getUTCHours()), &#x27;:&#x27;,
             pad(d.getUTCMinutes()), &#x27;:&#x27;, pad(d.getUTCSeconds()), &#x27;Z&#x27;].join(&#x27;&#x27;);
};

// http://webcloud.se/log/JavaScript-and-ISO-8601/
pkg.ISO8601toDate = function(v) {
    var regexp = [&quot;([0-9]{4})(-([0-9]{2})(-([0-9]{2})&quot;, &quot;(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?&quot;,
                  &quot;(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?&quot;].join(&#x27;&#x27;), d = v.match(new RegExp(regexp)),
                  offset = 0, date = new Date(d[1], 0, 1);

    if (d[3])  date.setMonth(d[3] - 1);
    if (d[5])  date.setDate(d[5]);
    if (d[7])  date.setHours(d[7]);
    if (d[8])  date.setMinutes(d[8]);
    if (d[10]) date.setSeconds(d[10]);
    if (d[12]) date.setMilliseconds(Number(&quot;0.&quot; + d[12]) * 1000);
    if (d[14]) {
        offset = (Number(d[16]) * 60) + Number(d[17]);
        offset *= ((d[15] == &#x27;-&#x27;) ? 1 : -1);
    }

    offset -= date.getTimezoneOffset();
    date.setTime(Number(date) + (offset * 60 * 1000));
    return date;
};

pkg.parseXML = function(s) {
    function rmws(node) {
        if (node.childNodes !== null) {
            for (var i = node.childNodes.length; i--&gt;0;) {
                var child= node.childNodes[i];
                if (child.nodeType === 3 &amp;&amp; child.data.match(/^\s*$/)) node.removeChild(child);
                if (child.nodeType === 1) rmws(child);
            }
        }
        return node;
    }

    if (typeof DOMParser !== &quot;undefined&quot;) return rmws((new DOMParser()).parseFromString(s, &quot;text/xml&quot;));
    else {
        for (var n in { &quot;Microsoft.XMLDOM&quot;:0, &quot;MSXML2.DOMDocument&quot;:1, &quot;MSXML.DOMDocument&quot;:2 }) {
            var p = null;
            try {
                p = new ActiveXObject(n);
                p.async = false;
            }  catch (e) { continue; }
            if (p === null) throw new Error(&quot;XML parser is not available&quot;);
            p.loadXML(s);
            return p;
        }
    }
    throw new Error(&quot;No XML parser is available&quot;);
};

/**
 * Query string parser class. The class provides number of 
 * useful static methods to manipulate with a query string 
 * of an URL 
 * @class QS
 * @static
 */
pkg.QS = Class([
    function $clazz() {
        /**
         * Append the given parameters to a query string of the specified URL 
         * @param  {String} url an URL
         * @param  {Object} obj a dictionary of parameters to be appended to 
         * the URL query string 
         * @return {String} a new URL
         * @static
         * @method append
         */
        this.append = function (url, obj) {
            return url + ((obj === null) ? &#x27;&#x27; : ((url.indexOf(&quot;?&quot;) &gt; 0) ? &#x27;&amp;&#x27; : &#x27;?&#x27;) + pkg.QS.toQS(obj, true));
        };

        /**
         * Fetch and parse query string of the given URL
         * @param  {String} url an URL
         * @return {Object} a parsed query string as a dictionary of parameters
         * @method parse
         * @static
         */
        this.parse = function(url) {
            var m = window.location.search.match(/[?&amp;][a-zA-Z0-9_.]+=[^?&amp;=]+/g), r = {};
            for(var i=0; m &amp;&amp; i &lt; m.length; i++) {
                var l = m[i].split(&#x27;=&#x27;);
                r[l[0].substring(1)] = decodeURIComponent(l[1]);
            }
            return r;
        };

        /**
         * Convert the given dictionary of parameters to a query string.
         * @param  {Object} obj a dictionary of parameters
         * @param  {Boolean} encode say if the parameters values have to be 
         * encoded 
         * @return {String} a query string built from parameters list
         * @static
         * @method toQS
         */
        this.toQS = function(obj, encode) {
            if (typeof encode === &quot;undefined&quot;) encode = true;
            if (zebra.isString(obj) || zebra.isBoolean(obj) || zebra.isNumber(obj)) return &quot;&quot; + obj;
            var p = [];
            for(var k in obj) {
                if (obj.hasOwnProperty(k)) p.push(k + &#x27;=&#x27; + (encode ? encodeURIComponent(obj[k].toString()) : obj[k].toString()));
            }
            return p.join(&quot;&amp;&quot;);
        };
    }
]);

//!!! type is intrenal IE specific parameter that indicates XDomainRequest or standard object has to be used
pkg.getRequest = function(type) {
    if (zebra.isIE || type === 0 || type === 1) {
        if ((location.protocol.toLowerCase() === &quot;file:&quot; &amp;&amp; type != 1) || type === 0) {
            return new (function() {
                var o = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;), $this = this;
                this.responseText = this.statusText = &quot;&quot;;
                this.onreadystatechange = this.responseXml = null;
                this.readyState = this.status = 0;
                this.__type = &quot;aie&quot;;
                o.onreadystatechange = function() {
                    $this.readyState = o.readyState;
                    if (o.readyState == 4) {
                        $this.responseText = o.responseText;
                        $this.responseXml  = o.responseXml;
                        $this.status     = o.status;
                        $this.statusText = o.statusText;
                    }
                    if ($this.onreadystatechange) $this.onreadystatechange();
                };

                this.open  = function(method, url, async, user, password) { return o.open(method, url, (async !== false), user, password); };
                this.send  = function(data) { return o.send(data); };
                this.abort = function(data) { return o.abort(); };
                this.setRequestHeader = function(name, value) { o.setRequestHeader(name, value); };
                this.getResponseHeader = function(name) { return o.getResponseHeader(name); };
                this.getAllResponseHeaders = function() { return o.getAllResponseHeaders(); };
            })();
        }

        var obj = new XDomainRequest();
        obj._open  = obj.open;
        obj._send  = obj.send;
        obj._async = true;
        obj.__type = &quot;xie&quot;;
        obj.statusText = &quot;&quot;;
        obj.status = obj.readyState = 0;
        obj.open = function(method, url, async, user, password) {
            this._async = (async === true);
            return this._open(method, url);
        };
        obj.setRequestHeader = obj.getResponseHeader = obj.getAllResponseHeaders = function () {
            throw new Error(&quot;Method is not supported&quot;);
        };

        obj.send = function(data) {
            var req = this;
            this.onerror =function() { req.status = 404; };
            this.onload = function() { req.status = 200; };

            if (this._async === false) {
                var result = this._send(data);
                while (this.status === 0) {
                    pkg.sleep();
                }
                this.readyState = 4;
                if (this.onreadystatechange) this.onreadystatechange();
                return result;
            }
            return this._send(data);
        };
        return obj;
    }

    var r = new XMLHttpRequest();
    if (zebra.isFF) {
        r.__send = r.send;
        r.send = function(data) {
            // !!! FF can throw NS_ERROR_FAILURE exception instead of returning 404 File Not Found HTTP error code
            // !!! No request status, statusText are defined in this case
            try { return this.__send(data); }
            catch(e) {
                if (!e.message || e.message.toUpperCase().indexOf(&quot;NS_ERROR_FAILURE&quot;) &lt; 0) throw e;
            }
        };
    }
    return r;
};

/**
 * HTTP request class. This class provides API to generate different (GET, POST, etc) HTTP requests in sync 
 * and async modes
 * @class HTTP
 * @constructor
 * @param {String} url an URL to a HTTP resource
 */
pkg.HTTP = Class([
    function(url) { this.url = url; },

    /**
     * Perform HTTP GET request .
     * @return {String} a result of the HTTP GET request
     * @method GET  
     */
    function GET() {
        return this.GET(null, null);
    },

    /**
     * Perform HTTP GET request asynchronously.
     * @param {Function} f a callback function that is called when the HTTP GET 
     * request is done. The method gets a response string as the first argument 
     * and the original request object as the second argument.
        
        zebra.io.HTTP(&quot;google.com&quot;).GET(function(result, request) {
            // handle HTTP GET response
            ...
        });

     * @method GET  
     */
    function GET(f) {
        return (typeof f === &#x27;function&#x27;) ? this.GET(null, f) : this.GET(f, null);
    },
    
    /**
     * Perform HTTP GET request synchronously or asynchronously with the given 
     * query parameters.
     * @param {Object} d a dictionary of query parameters 
     * @param {Function} [f] a callback function that is called when the HTTP GET 
     * request is done. The method gets a response string as the first argument 
     * and the original request object as the second argument.
    
        // synchronous HTTP GET request with the number of
        // query parameters
        var result = zebra.io.HTTP(&quot;google.com&quot;).GET({
            param1: &quot;var1&quot;,
            param3: &quot;var2&quot;,
            param3: &quot;var3&quot;
        });

     * @method GET  
     */
    function GET(d, f) {
        return this.SEND(&quot;GET&quot;, pkg.QS.append(this.url, d), null, f);
    },


    /**
     * Perform synchronously HTTP POST request. No any data is sent with the POST request.
     * @return {String} a result of HTTP POST request
     * @method POST
     */
    function POST(){
        return this.POST(null, null);
    },
    
    /**
     * Perform HTTP POST request asynchronously with no parameters or synchronously 
     * with the given parameters list.
     * @param {Function|Object} d a callback function that is called when HTTP POST 
     * request is done. The method gets a response string as the first argument 
     * and the original request object as the second argument:
        
        // asynchronously send POST
        zebra.io.HTTP(&quot;google.com&quot;).POST(function(result, request) {
            // handle HTTP GET response
            ...
        });

     * Or you can pass a number of parameters to be sent synchronously by 
     * HTTP POST request: 

        // send parameters synchronously by HTTP POST request
        zebra.io.HTTP(&quot;google.com&quot;).POST({
            param1: &quot;val1&quot;,
            param2: &quot;val3&quot;,
            param3: &quot;val3&quot; 
        });

     * @method POST
     */
    function POST(d) {
        return (typeof d === &quot;function&quot;) ? this.POST(null, d)
                                         : this.POST(pkg.QS.toQS(d, false), null);
    },

    /**
     * Perform HTTP POST request synchronously or asynchronously with the given 
     * data to be sent.
     * @param {String} d a data to be sent by HTTP POST request
     * @param {Function} [f] a callback function that is called when HTTP POST 
     * request is done. The method gets a response string as the first argument 
     * and the original request object as the second argument. If the callback
     * is null the POST request will be done synchronously. The method gets a 
     * response string as the first argument and the original request object 
     * as the second argument. 
     * @method POST
     */
    function POST(d, f) {
        return this.SEND(&quot;POST&quot;, this.url, d, f);
    },

    /**
     * Universal HTTP request method that can be used to generate 
     * a HTTP request with any HTTP method to the given URL with 
     * the given data to be sent asynchronously or synchronously
     * @param {String}   method   an HTTP method (GET,POST,DELETE,PUT, etc)
     * @param {String}   url      an URL
     * @param {String}   data     a data to be sent to the given URL
     * @param {Function} [callback] a callback method to be defined 
     * if the HTTP request has to be sent asynchronously. 
     * @method SEND
     */
    function SEND(method, url, data, callback) {
        //!!! IE9 returns 404 if XDomainRequest is used for the same domain but for different paths.
        //!!! Using standard XMLHttpRequest has to be forced in this case
        var t = zebra.isIE &amp;&amp; (new zebra.URL(url)).host.toLowerCase() == location.host.toLowerCase() ? 0 : -1,
            r = pkg.getRequest(t), $this = this;

        if (callback !== null) {
            r.onreadystatechange = function() {
                if (r.readyState == 4) {
                    $this.httpError(r, url);
                    callback(r.responseText, r);
                }
            };
        }

        r.open(method, url, callback !== null);
        r.send(data);
        if (callback === null) {
            this.httpError(r, url);
            return r.responseText;
        }
    },

    /**
     * Called every time an error in a HTTP request has happened
     * @param  {HttpRequest} r an original request object 
     * @param  {String} url an URL
     * @method httpError
     */
    function httpError(r, url) { 
        if (r.status != 200) {
            throw new Error(&quot;HTTP error &quot; + r.status + &quot; response = &#x27;&quot; + r.responseText + &quot;&#x27; url = &quot; + url); 
        }
    }
]);

/**
 * Shortcut method to perform asynchronous or synchronous HTTP GET requests.
 
        // synchronous HTTP GET call
        var res = zebra.ui.GET(&quot;http://test.com&quot;);

        // asynchronous HTTP GET call
        zebra.ui.GET(&quot;http://test.com&quot;, function(res, request) {
            // handle result
            ...
        });

        // synchronous HTTP GET call with query parameters
        var res = zebra.ui.GET(&quot;http://test.com&quot;, {
            param1 : &quot;var1&quot;,
            param1 : &quot;var2&quot;,
            param1 : &quot;var3&quot;
        });

 * @param {String} url an URL
 * @param {Object} [parameters] a dictionary of query parameters 
 * @param {Funcion} [callback] a callback function that is called 
 * when the GET request is completed. Pass it if to perform request
 * asynchronously 
 * @for  GET()
 * @method GET
 */
pkg.GET = function(url) {
    var http = new pkg.HTTP(url);
    return http.GET.apply(http, Array.prototype.slice.call(arguments, 1));
};
/**
 * @for GET()
 */


/**
 * Shortcut method to perform asynchronous or synchronous HTTP POST requests.
 
        // synchronous HTTP POST call
        var res = zebra.ui.POST(&quot;http://test.com&quot;);

        // asynchronous HTTP POST call
        zebra.ui.POST(&quot;http://test.com&quot;, function(res, request) {
            // handle result
            ...
        });

        // synchronous HTTP POST call with query parameters
        var res = zebra.ui.POST(&quot;http://test.com&quot;, {
            param1 : &quot;var1&quot;,
            param1 : &quot;var2&quot;,
            param1 : &quot;var3&quot;
        });

        // synchronous HTTP POST call with data
        var res = zebra.ui.POST(&quot;http://test.com&quot;, &quot;data&quot;);

        // asynchronous HTTP POST call with data
        zebra.ui.POST(&quot;http://test.com&quot;, &quot;data&quot;, function(res, request) {
            // handle result
        });

 * @param {String} url an URL
 * @param {Object} [parameters] a dictionary of query parameters 
 * @param {Funcion} [callback] a callback function that is called 
 * when the GET request is completed. Pass it if to perform request
 * asynchronously 
 * @method  POST
 * @for  POST()
 */
pkg.POST = function(url) {
    var http = new pkg.HTTP(url);
    return http.POST.apply(http, Array.prototype.slice.call(arguments, 1));
};
/**
 * @for POST()
 */


var isBA = typeof(ArrayBuffer) !== &#x27;undefined&#x27;;
pkg.InputStream = Class([
    function(container) {
        if (isBA &amp;&amp; container instanceof ArrayBuffer) this.data = new Uint8Array(container);
        else {
            if (zebra.isString(container)) {
                this.Field(function read() { return this.available() &gt; 0 ? this.data.charCodeAt(this.pos++) &amp; 0xFF : -1; });
            }
            else {
                if (Array.isArray(container) === false) throw new Error(&quot;Wrong type: &quot; + typeof(container));
            }
            this.data = container;
        }
        this.marked = -1;
        this.pos    = 0;
    },

    function mark() {
        if (this.available() &lt;= 0) throw new Error();
        this.marked = this.pos;
    },

    function reset() {
        if (this.available() &lt;= 0 || this.marked &lt; 0) throw new Error();
        this.pos    = this.marked;
        this.marked = -1;
    },

    function close()   { this.pos = this.data.length; },
    function read()    { return this.available() &gt; 0 ? this.data[this.pos++] : -1; },
    function read(buf) { return this.read(buf, 0, buf.length); },

    function read(buf, off, len) {
        for(var i = 0; i &lt; len; i++) {
            var b = this.read();
            if (b &lt; 0) return i === 0 ? -1 : i;
            buf[off + i] = b;
        }
        return len;
    },

    function readChar() {
        var c = this.read();
        if (c &lt; 0) return -1;
        if (c &lt; 128) return String.fromCharCode(c);

        var c2 = this.read();
        if (c2 &lt; 0) throw new Error();

        if (c &gt; 191 &amp;&amp; c &lt; 224) return String.fromCharCode(((c &amp; 31) &lt;&lt; 6) | (c2 &amp; 63));
        else {
            var c3 = this.read();
            if (c3 &lt; 0) throw new Error();
            return String.fromCharCode(((c &amp; 15) &lt;&lt; 12) | ((c2 &amp; 63) &lt;&lt; 6) | (c3 &amp; 63));
        }
    },

    function readLine() {
        if (this.available() &gt; 0)
        {
            var line = [], b;
            while ((b = this.readChar()) != -1 &amp;&amp; b != &quot;\n&quot;) line.push(b);
            var r = line.join(&#x27;&#x27;);
            line.length = 0;
            return r;
        }
        return null;
    },

    function available() { return this.data === null ? -1 : this.data.length - this.pos; },
    function toBase64() { return pkg.b64encode(this.data); }
]);

pkg.URLInputStream = Class(pkg.InputStream, [
    function(url) {  this.$this(url, null); },

    function(url, f) {
        var r = pkg.getRequest(), $this = this;
        r.open(&quot;GET&quot;, url, f !== null);
        if (f === null || isBA === false) {
            if (!r.overrideMimeType) throw new Error(&quot;Binary mode is not supported&quot;);
            r.overrideMimeType(&quot;text/plain; charset=x-user-defined&quot;);
        }

        if (f !== null)  {
            if (isBA) r.responseType = &quot;arraybuffer&quot;;
            r.onreadystatechange = function() {
                if (r.readyState == 4) {
                    if (r.status != 200)  throw new Error(url);
                    $this.getClazz().$parent.getMethod(&#x27;&#x27;, 1).call($this, isBA ? r.response : r.responseText); // $this.$super(res);
                    f($this.data, r);
                }
            };
            r.send(null);
        }
        else {
            r.send(null);
            if (r.status != 200) throw new Error(url);
            this.$super(r.responseText);
        }
    },

    function close() {
        this.$super();
        if (this.data) {
            this.data.length = 0;
            this.data = null;
        }
    }
]);

/**
 * A remote service connector class. It is supposed the class has to be extended with 
 * different protocols like RPC, JSON etc. The typical pattern of connecting to 
 * a remote service is shown below:
 
        // create service connector that has two methods &quot;a()&quot; and &quot;b(param1)&quot;
        var service = new zebra.io.Service(&quot;http://myservice.com&quot;, [
            &quot;a&quot;, &quot;b&quot;
        ]);

        // call the methods of the remote service
        service.a();
        service.b(10);

 * Also the methods of a remote service can be called asynchronously. In this case
 * a callback method has to be passed as the last argument of called remote methods:

        // create service connector that has two methods &quot;a()&quot; and &quot;b(param1)&quot;
        var service = new zebra.io.Service(&quot;http://myservice.com&quot;, [
            &quot;a&quot;, &quot;b&quot;
        ]);

        // call &quot;b&quot; method from the remote service asynchronously
        service.b(10, function(res) {
            // handle a result of the remote method execution here
            ...
        });
 *
 * Ideally any specific remote service extension of &quot;zebra.io.Service&quot;
 * class has to implement two methods:
 
    - **encode** to say how the given remote method with passed parameters have
    to be transformed into a concrete service side protocol (JSON, XML, etc)
    - **decode** to say how the specific service response has to be converted into 
    JavaScript object 

 * @class  Service 
 * @constructor
 * @param {String} url an URL of remote service
 * @param {Array} methods a list of methods names the remote service provides  
 */
pkg.Service = Class([
    function(url, methods) {
        var $this = this;
        /**
         * Remote service url
         * @attribute url
         * @readOnly
         * @type {String}
         */
        this.url = url;


        /**
         * Remote service methods names
         * @attribute methods
         * @readOnly
         * @type {Array}
         */

        if (Array.isArray(methods) === false) methods = [ methods ];

        for(var i=0; i &lt; methods.length; i++) {
            (function() {
                var name = methods[i];
                $this[name] = function() {
                    var args = Array.prototype.slice.call(arguments);
                    if (args.length &gt; 0 &amp;&amp; typeof args[args.length - 1] == &quot;function&quot;) {
                        var callback = args.pop();
                        return this.send(url, this.encode(name, args), function(res) { callback($this.decode(res)); } );
                    }
                    return this.decode(this.send(url, this.encode(name, args), null));
                };
            })();
        }
    },

    /**
     * Transforms the given remote method execution with the specified parameters
     * to service specific protocol. 
     * @param {String} name a remote method name
     * @param {Array} args an passed to the remote method arguments 
     * @return {String} a remote service specific encoded string 
     * @protected
     * @method encode
     */

    /**
     * Transforms the given remote method response to a JavaScript 
     * object.
     * @param {String} name a remote method name
     * @return {Object} a result of the remote method calling as a JavaScript 
     * object
     * @protected
     * @method decode
     */

     /**
      * Send the given data to the given url and return a response. Callback 
      * function can be passed for asynchronous result handling.
      * @protected
      * @param  {String}   url an URL
      * @param  {String}   data  a data to be send
      * @param  {Function} [callback] a callback function  
      * @return {String}  a result
      * @method  send
      */
    function send(url, data, callback) { return pkg.POST(url, data, callback); }
]);

pkg.Service.invoke = function(clazz, url, method) {
    var rpc = new clazz(url, method);
    return function() { return rpc[method].apply(rpc, arguments); };
};

/**
 * The class is implementation of JSON-RPC remote service connector.
 
        // create JSON-RPC connector to a remote service that 
        // has three remote methods
        var service = new zebra.io.JRPC(&quot;json-rpc.com&quot;, [
            &quot;method1&quot;, &quot;method2&quot;, &quot;method3&quot;
        ]);

        // synchronously call remote method &quot;method1&quot; 
        service.method1();
        
        // asynchronously call remote method &quot;method1&quot; 
        service.method1(function(res) {
            ...
        });

 * @class JRPC
 * @constructor
 * @param {String} url an URL of remote service
 * @param {Array} methods a list of methods names the remote service provides  
 * @extends {zebra.io.Service}
 */
pkg.JRPC = Class(pkg.Service, [
    function(url, methods) {
        this.$super(url, methods);
        this.version = &quot;2.0&quot;;
    },

    function encode(name, args) {
        return JSON.stringify({ jsonrpc: this.version, method: name, params: args, id: pkg.ID() });
    },

    function decode(r) {
        if (r === null || r.length === 0) throw new Error(&quot;Empty JSON result string&quot;);
        r = JSON.parse(r);
        if (typeof(r.error) !== &quot;undefined&quot;) throw new Error(r.error.message);
        if (typeof r.result === &quot;undefined&quot; || typeof r.id === &quot;undefined&quot;) throw new Error(&quot;Wrong JSON response format&quot;);
        return r.result;
    }
]);

pkg.Base64 = function(s) { if (arguments.length &gt; 0) this.encoded = pkg.b64encode(s); };
pkg.Base64.prototype.toString = function() { return this.encoded; };
pkg.Base64.prototype.decode   = function() { return pkg.b64decode(this.encoded); };

/**
 * The class is implementation of XML-RPC remote service connector.

        // create XML-RPC connector to a remote service that 
        // has three remote methods
        var service = new zebra.io.XRPC(&quot;xmlrpc.com&quot;, [
            &quot;method1&quot;, &quot;method2&quot;, &quot;method3&quot;
        ]);

        // synchronously call remote method &quot;method1&quot; 
        service.method1();

        // asynchronously call remote method &quot;method1&quot; 
        service.method1(function(res) {
            ...
        });

 * @class XRPC
 * @constructor
 * @extends {zebra.io.Service}
 * @param {String} url an URL of remote service
 * @param {Array} methods a list of methods names the remote service provides  
 */
pkg.XRPC = Class(pkg.Service, [
    function(url, methods) { this.$super(url, methods); },

    function encode(name, args) {
        var p = [&quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;\n&lt;methodCall&gt;&lt;methodName&gt;&quot;, name, &quot;&lt;/methodName&gt;&lt;params&gt;&quot;];
        for(var i=0; i &lt; args.length;i++) {
            p.push(&quot;&lt;param&gt;&quot;);
            this.encodeValue(args[i], p);
            p.push(&quot;&lt;/param&gt;&quot;);
        }
        p.push(&quot;&lt;/params&gt;&lt;/methodCall&gt;&quot;);
        return p.join(&#x27;&#x27;);
    },

    function encodeValue(v, p)  {
        if (v === null) throw new Error(&quot;Null is not allowed&quot;);

        if (zebra.isString(v)) {
            v = v.replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;);
            v = v.replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;);
            p.push(&quot;&lt;string&gt;&quot;, v, &quot;&lt;/string&gt;&quot;);
        }
        else {
            if (zebra.isNumber(v)) {
                if (Math.round(v) == v) p.push(&quot;&lt;i4&gt;&quot;, v.toString(), &quot;&lt;/i4&gt;&quot;);
                else                    p.push(&quot;&lt;double&gt;&quot;, v.toString(), &quot;&lt;/double&gt;&quot;);
            }
            else {
                if (zebra.isBoolean(v)) p.push(&quot;&lt;boolean&gt;&quot;, v?&quot;1&quot;:&quot;0&quot;, &quot;&lt;/boolean&gt;&quot;);
                else {
                    if (v instanceof Date)  p.push(&quot;&lt;dateTime.iso8601&gt;&quot;, pkg.dateToISO8601(v), &quot;&lt;/dateTime.iso8601&gt;&quot;);
                    else {
                        if (Array.isArray(v))  {
                            p.push(&quot;&lt;array&gt;&lt;data&gt;&quot;);
                            for(var i=0;i&lt;v.length;i++) {
                                p.push(&quot;&lt;value&gt;&quot;);
                                this.encodeValue(v[i], p);
                                p.push(&quot;&lt;/value&gt;&quot;);
                            }
                            p.push(&quot;&lt;/data&gt;&lt;/array&gt;&quot;);
                        }
                        else {
                            if (v instanceof pkg.Base64) p.push(&quot;&lt;base64&gt;&quot;, v.toString(), &quot;&lt;/base64&gt;&quot;);
                            else {
                                p.push(&quot;&lt;struct&gt;&quot;);
                                for(var k in v) {
                                    if (v.hasOwnProperty(k)) {
                                        p.push(&quot;&lt;member&gt;&lt;name&gt;&quot;, k, &quot;&lt;/name&gt;&lt;value&gt;&quot;);
                                        this.encodeValue(v[k], p);
                                        p.push(&quot;&lt;/value&gt;&lt;/member&gt;&quot;);
                                    }
                                }
                                p.push(&quot;&lt;/struct&gt;&quot;);
                            }
                        }
                    }
                }
            }
        }
    },

    function decodeValue(node) {
        var tag = node.tagName.toLowerCase();
        if (tag == &quot;struct&quot;)
        {
             var p = {};
             for(var i=0; i &lt; node.childNodes.length; i++) {
                var member = node.childNodes[i],  // &lt;member&gt;
                    key    = member.childNodes[0].childNodes[0].nodeValue.trim(); // &lt;name&gt;/text()
                p[key] = this.decodeValue(member.childNodes[1].childNodes[0]);   // &lt;value&gt;/&lt;xxx&gt;
            }
            return p;
        }
        if (tag == &quot;array&quot;) {
            var a = [];
            node = node.childNodes[0]; // &lt;data&gt;
            for(var i=0; i &lt; node.childNodes.length; i++) {
                a[i] = this.decodeValue(node.childNodes[i].childNodes[0]); // &lt;value&gt;
            }
            return a;
        }

        var v = node.childNodes[0].nodeValue.trim();
        switch (tag) {
            case &quot;datetime.iso8601&quot;: return pkg.ISO8601toDate(v);
            case &quot;boolean&quot;: return v == &quot;1&quot;;
            case &quot;int&quot;:
            case &quot;i4&quot;:     return parseInt(v, 10);
            case &quot;double&quot;: return Number(v);
            case &quot;base64&quot;:
                var b64 = new pkg.Base64();
                b64.encoded = v;
                return b64;
            case &quot;string&quot;: return v;
        }
        throw new Error(&quot;Unknown tag &quot; + tag);
    },

    function decode(r) {
        var p = pkg.parseXML(r), c = p.getElementsByTagName(&quot;fault&quot;);
        if (c.length &gt; 0) {
            var err = this.decodeValue(c[0].getElementsByTagName(&quot;struct&quot;)[0]);
            throw new Error(err.faultString);
        }
        c = p.getElementsByTagName(&quot;methodResponse&quot;)[0];
        c = c.childNodes[0].childNodes[0]; // &lt;params&gt;/&lt;param&gt;
        if (c.tagName.toLowerCase() === &quot;param&quot;) return this.decodeValue(c.childNodes[0].childNodes[0]); // &lt;value&gt;/&lt;xxx&gt;
        throw new Error(&quot;incorrect XML-RPC response&quot;);
    }
]);

/**
 * Shortcut to call the specified method of a XML-RPC service.
 * @param  {String} url an URL
 * @param  {String} method a method name
 * @for zebra.io.XRPC.invoke()
 * @method invoke
 */
pkg.XRPC.invoke = function(url, method) {
    return pkg.Service.invoke(pkg.XRPC, url, method);
};
/**
 * @for zebra.io.XRPC.invoke()
 */

/**
 * Shortcut to call the specified method of a JSON-RPC service.
 * @param  {String} url an URL
 * @param  {String} method a method name
 * @for zebra.io.JRPC.invoke()
 * @method invoke
 */
pkg.JRPC.invoke = function(url, method) {
    return pkg.Service.invoke(pkg.JRPC, url, method);
};
/**
 * @for zebra.io.JRPC.invoke()
 */

})(zebra(&quot;io&quot;), zebra.Class);

</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
